name: qodana

on:
    push:
        branches:
            - "**"

permissions:
    contents: read

jobs:
    qodana:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v4
            
            # QODANA_TOKEN muss als Repo-Secret existieren (hast du bereits)
            - name: Run Qodana
              uses: JetBrains/qodana-action@v2025.3
              env:
                  QODANA_TOKEN: ${{ secrets.QODANA_TOKEN }}
              with:
                  # Wichtig: Wir wollen NICHTS "hochladen" auÃŸer Artefakt
                  # => Report/Results lokal im Runner ablegen
                  results-dir: qodana-results
            
            # Nur Artefakt, keine GitHub Code Scanning Integration
            - name: Upload SARIF artifact
              uses: actions/upload-artifact@v4
              with:
                  name: qodana-sarif
                  path: qodana-results/qodana.sarif.json
                  if-no-files-found: error
